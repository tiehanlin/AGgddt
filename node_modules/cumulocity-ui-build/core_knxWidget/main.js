/* core_knxWidget 8.7.2 2017-08-02T09:54:33+00:00 e22b35b1d531 (hotfix/8.7.2) tip */
!function(){"use strict";function e(e,n){var t="core_knxWidget/views/";e.add({name:"KNX Device Widget",description:n("Allows for seeing status and operating modbus device"),templateUrl:t+"widget.html",configTemplateUrl:t+"widgetConfig.html"})}angular.module("c8y.knxWidget",[]).config(["c8yComponentsProvider","gettext",e])}(),function(){"use strict";function e(e,n,t,i,l,a,d,s,o){function r(e){return!0}function c(e){return!!e.changePending}function u(e,n){f(e,n,p)}function g(e,n){f(e,n,m)}function f(e,n,t){if(r(e)){var i=t(e,n);e.changePending=!0,b(i).then(function(t){t.status===l.status.SUCCESSFUL?(e.value=n,e.changePending=!1):t.status===l.status.FAILED&&(e.changePending=!1)})}}function p(e,n){return v(e,n)}function m(e,n){var t=v(e,n);return t.description=o.getString("{{fieldName}} value switched to {{fieldValue}}",{fieldName:e.name,fieldValue:n}),t}function v(n,t){return{deviceId:e.child.config.device.id,description:o.getString("{{fieldName}} value changed to {{value}} {{(fieldUnit) ? (' ' + fieldUnit) : ('')}}",{fieldName:n.name,value:t,fieldUnit:n.unit}),c8y_SetRegister:{address:n.address,value:t}}}function b(e){return l.createWithNotifications(e).then(function(n){return n.created.then(_.partial(a.success,o.getString('Operation "{{opDescription}}" has been created!',{opDescription:e.description}))),n.completed.then(function(n){return n.status===l.status.SUCCESSFUL?a.success(o.getString('Operation "{{opDescription}}" has been completed successfully!',{opDescription:e.description})):n.status===l.status.FAILED&&a.danger(o.getString('Operation "{{opDescription}}" has failed!',{opDescription:e.description})),n})})}e.canUpdateField=r,e.isFieldChangePending=c,e.updateRegisterField=u,e.updateCoilField=g}angular.module("c8y.knxWidget").controller("knxWidgetCtrl",["$scope","$q","c8yBase","c8yDevices","c8yDeviceControl","c8yAlert","c8yRealtime","gettext","gettextCatalog",e])}(),function(){"use strict";function e(e){function n(){e.config.fields=e.config.fields||[]}function t(){e.config.fields.push(i())}function i(){return{type:o[0].value}}function l(n){e.config.fields=_.filter(e.config.fields,function(e){return e!==n})}function a(e){e.buttons=e.buttons||[],e.buttons.push(d())}function d(){return{label:"",value:""}}function s(e,n){e.buttons=_.filter(e.buttons,function(e){return e!==n})}var o=[{label:"Number",value:"number"},{label:"Buttons",value:"buttons"}];e.fieldTypes=o,e.addField=t,e.removeField=l,e.addButton=a,e.removeButton=s,n()}angular.module("c8y.knxWidget").controller("knxWidgetConfigCtrl",["$scope","$routeParams",e])}(),function(){"use strict";function e(e){var n;n='<div ng-controller="knxWidgetCtrl" class="knxWidget">\n  <div ng-repeat="field in child.config.fields">\n    <div ng-switch="field.type">\n      <div ng-switch-when="number">\n        <div class="row">\n          <div class="col-lg-8">\n            <div class="form-group">\n              <label ng-class="{\'notEditable\': !canUpdateField(field)}">{{field.name}}</label>\n              <input type="number" class="form-control text-right" ng-class="{\'input-border\': canUpdateField(field)}" ng-disabled="!canUpdateField(field) || isFieldChangePending(field)" ng-model="field.value">\n              <span ng-show="field.unit" style="font-size:18px">{{field.unit}}</span>\n              <button class="btn btn-primary" type="submit" ng-show="canUpdateField(field)" ng-click="updateRegisterField(field, field.value)" ng-disabled="isFieldChangePending(field)">\n                <span ng-hide="isFieldChangePending(field)" translate>Set</span>\n                <span ng-show="isFieldChangePending(field)"><i c8y-icon="spinner" class="fa-spin"></i> <translate>Setting&hellip;</translate></span>\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div ng-switch-when="buttons">\n        <div class="row">\n          <div class="col-lg-8">\n            <div class="form-group">\n              <label ng-class="{\'notEditable\': !canUpdateField(field)}">{{field.name}}</label>\n              <div class="btn-group" style="margin-bottom: 10px">\n                <button type="button" class="btn btn-default" ng-repeat="button in field.buttons" ng-click="updateCoilField(field, button.value)" ng-class="{active: field.value === button.value}" ng-disabled="!canUpdateField(field) || isFieldChangePending(field)">{{button.label | translate}}</button>\n                <button type="button" class="btn btn-default" ng-show="isFieldChangePending(field)" disabled="disabled"><i c8y-icon="spinner" class="fa-spin"></i></button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n',e.put("core_knxWidget/views/widget.html",n),e.put("/apps/core/knxWidget/views/widget.html",n),n='<div ng-controller="knxWidgetConfigCtrl">\n  <div class="form-group">\n    <label style="display: block; clear: both">\n        <translate>Fields</translate>\n      <a class="btn btn-link pull-right" style="padding: 0" ng-click="addField()">\n          <i c8y-icon="plus"></i> <translate>Add field</translate>\n      </a>\n    </label>\n    <div ng-repeat="field in config.fields">\n      <div class="form-group" style="margin-bottom: 10px">\n        <label class="text-muted" style="display: block; clear: both">\n          <span ng-hide="field.name" translate>Unnamed field</span>\n          <span ng-show="field.name">{{field.name}} <span ng-show="field.address" translate>{{at {{field.address}}</span></span>\n          <a class="btn btn-link pull-right" style="padding: 0" ng-click="removeField(field)">\n              <i c8y-icon="minus"></i> <translate>Remove field</translate>\n          </a>\n        </label>\n        <div class="form-inline" style="clear: both">\n          <ng-form name="nestedFieldNameForm">\n            <div class="form-group col-lg-4" ng-class="{\'has-error\': nestedFieldNameForm.$dirty && nestedFieldNameForm.$invalid}">\n              <input type="text" class="form-control" ng-model="field.name" placeholder="{{\'Name\' | translate}}" uib-tooltip="{{\'Name\' | translate}}" required/>\n            </div>\n          </ng-form>\n          <ng-form name="nestedFieldAddressForm">\n            <div class="form-group col-lg-4" ng-class="{\'has-error\': nestedFieldAddressForm.$dirty && nestedFieldAddressForm.$invalid}">\n              <input type="text" class="form-control" ng-model="field.address" placeholder="{{\'KNX address\' | translate}}" uib-tooltip="{{\'KNX address\' | translate}}" required/>\n            </div>\n          </ng-form>\n          <ng-form name="nestedFieldTypeForm">\n            <div class="form-group col-lg-4" ng-class="{\'has-error\': nestedFieldTypeForm.$dirty && nestedFieldTypeForm.$invalid}">\n              <select class="form-control" ng-model="field.type" ng-options="fieldType.value as fieldType.label for fieldType in fieldTypes" uib-tooltip="{{\'Type\' | translate}}" required></select>\n            </div>\n          </ng-form>\n        </div>\n        <div style="clear: both">\n          <div ng-if="field.type === \'buttons\'">\n            <div ng-repeat="button in field.buttons" class="form-inline" style="clear: both">\n              <div class="form-group" style="margin-top: 10px">\n                <ng-form name="nestedButtonLabelForm">\n                  <div class="form-group col-lg-4" ng-class="{\'has-error\': nestedButtonLabelForm.$dirty && nestedButtonLabelForm.$invalid}">\n                    <input type="text" class="form-control" ng-model="button.label" placeholder="{{\'Label\' | translate}}" uib-tooltip="{{\'Label\' | translate}}" required/>\n                  </div>\n                </ng-form>\n                <ng-form name="nestedButtonValueForm">\n                  <div class="form-group col-lg-4" ng-class="{\'has-error\': nestedButtonValueForm.$dirty && nestedButtonValueForm.$invalid}">\n                    <input type="text" class="form-control" ng-model="button.value" placeholder="{{\'Value\' | translate}}" uib-tooltip="{{\'Value\' | translate}}" required/>\n                  </div>\n                </ng-form>\n                <a class="btn btn-link pull-right" ng-click="removeButton(field, button)">\n                    <i c8y-icon="minus"></i> <translate>Remove button</translate>\n                </a>\n              </div>\n            </div>\n            <a class="btn btn-link" ng-click="addButton(field)">\n                <i c8y-icon="plus"></i> <translate>Add button</translate>\n            </a>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n',e.put("core_knxWidget/views/widgetConfig.html",n),e.put("/apps/core/knxWidget/views/widgetConfig.html",n)}angular.module("c8y.knxWidget").run(["$templateCache",e])}();