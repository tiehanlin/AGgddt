/* core_firmwareList 8.7.2 2017-08-02T09:54:24+00:00 e22b35b1d531 (hotfix/8.7.2) tip */
angular.module("c8y.parts.firmwareList",[]).config(["c8yNavigatorProvider","c8yViewsProvider","gettext",function(n,e,t){"use strict";var r="download",a=t("Firmware");n.addNavigation({parent:t("Management"),name:t("Firmware repository"),priority:1e3,path:"firmware",icon:r}),e.when("/firmware",{name:a,templateUrl:"core_firmwareList/views/index.html"})}]),angular.module("c8y.parts.firmwareList").controller("firmwareListCtrl",["$scope","c8yInventory","c8yModal","c8yBase","c8yTitle","c8yAlert","gettext","gettextCatalog",function(n,e,t,r,a,l,i,o){"use strict";function s(){a.changeTitle({title:i("Firmware repository")})}function c(e){n.firmwares&&!n.refreshLoading||(n.firmwares=[]),n.paging=e.paging,e.forEach(function(e){n.firmwares.push(e)})}function d(n){return _.assign({type:x},n||{})}function u(n){var t=d(n);return e.list(t).then(c)}function f(){n.paging.loading=!0,n.paging.next().then(c).finally(function(){n.paging.loading=!1})}function m(){n.refreshLoading=!0,n.paging.refresh().then(c).finally(function(){n.refreshLoading=!1})}function g(n){return k.indexOf(n)}function w(n){return g(n)>-1}function p(n){w(n)?k.splice(g(n),1):k.push(n)}function b(a){t({title:i("Confirm delete?"),body:o.getString('Do you really want to remove firmware "{{name}}"?',{name:a.name}),status:"danger"}).then(angular.bind(e,e.remove,a)).then(angular.bind(r,r.removeFromList,n.firmwares,a)).then(function(){l.success(i("Firmware successfully removed."))})}function y(t){e.save(v(t)).then(function(){l.success(i("Firmware successfully added.")),m(),n.newFw=null})}function v(n){return n.url=n.selectedFile.url,delete n.selectedFile,n}function h(){n.newFw={type:x}}function F(){n.newFw=null}var x="c8y_Firmware",k=[];n.loadNext=f,n.refresh=m,n.toggle=p,n.isOpen=w,n.onClickDelete=b,n.save=y,n.add=h,n.cancelAdd=F,u(),s()}]),function(){"use strict";function n(n){var e;e='<div data-ng-controller="firmwareListCtrl">\n\n  <div class="clearfix">\n    <c8y-refresh-btn class="pull-right" style="margin-bottom:20px"></c8y-refresh-btn>\n    <button class="btn btn-link pull-right" data-ng-click="add()">\n        <i c8y-icon="plus"></i> <translate>Add firmware</translate>\n    </button>\n  </div>\n\n  <form role="form" name="newFirmware" class="panel-body" novalidate ng-show="!!newFw.type">\n    <div class="row">\n      <div class="form-group col-lg-4">\n        <label translate>Name</label>\n        <input type="text" class="form-control" ng-model="newFw.name" required>\n      </div>\n      <div class="form-group col-lg-4">\n        <label translate>Version</label>\n        <input type="text" class="form-control" ng-model="newFw.version">\n      </div>\n      <div class="form-group col-lg-4">\n        <label translate>File</label>\n        <c8y-binary-input initial-url="newFw.url" output-file="newFw.selectedFile" allow-free-url-input="true" file-required="true"></c8y-binary-input>\n      </div>\n    </div>\n\n    <button class="btn btn-primary" ng-click="save(newFw)" ng-disabled="newFirmware.$invalid" translate>Save</button>\n    <button class="btn btn-default" ng-click="cancelAdd()" translate>Cancel</button>\n  </form>\n\n\n  <table class="table">\n    <thead>\n      <tr>\n        <th translate>Name</th>\n        <th translate>Version</th>\n        <th style="width:30px"></th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr ng-repeat-start="fw in firmwares | orderBy:[\'name\',\'version\']" class="interact" ng-class="{active: isOpen(fw)}">\n        <td ng-click="toggle(fw)" class="word-break">{{fw.name}}</td>\n        <td ng-click="toggle(fw)" class="word-break">{{fw.version}}</td>\n        <td class="text-right">\n          <button class="btn btn-danger btn-xs showOnHover" title="{{\'Delete firmware\' | translate}}" data-ng-click="onClickDelete(fw)">\n            <i c8y-icon="times"></i>\n          </button>\n        </td>\n      </tr>\n      <tr ng-repeat-end data-ng-if="isOpen(fw)">\n        <td colspan="3">\n          <form name="firmwareForm" role="form">\n            <div class="row">\n              <div class="form-group col-lg-4">\n                <label translate>Name</label>\n                <input type="text" class="form-control" ng-model="fw.name">\n              </div>\n              <div class="form-group col-lg-4">\n                <label translate>Version</label>\n                <input type="text" class="form-control" ng-model="fw.version">\n              </div>\n              <div class="form-group col-lg-4">\n                <label translate>File</label>\n                <c8y-binary-input initial-url="fw.url" output-file="fw.selectedFile" allow-free-url-input="true"></c8y-binary-input>\n              </div>\n            </div>\n\n            <button class="btn btn-primary" ng-click="save(fw)" ng-disabled="firmwareForm.$invalid" translate>Save</button>\n            <button class="btn btn-default" ng-click="toggle(fw)" translate>Close</button>\n          </form>\n        </td>\n      </tr>\n    <tbody>\n  </tbody></tbody></table>\n\n  <c8y-load-more></c8y-load-more>\n\n</div>\n',n.put("core_firmwareList/views/index.html",e),n.put("/apps/core/firmwareList/views/index.html",e)}angular.module("c8y.parts.firmwareList").run(["$templateCache",n])}();