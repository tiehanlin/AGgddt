/* core_deviceDetailIdentity 8.7.2 2017-08-02T09:54:12+00:00 e22b35b1d531 (hotfix/8.7.2) tip */
angular.module("c8y.deviceDetailIdentity",[]).config(["c8yViewsProvider","c8ySearchProvider","gettext",function(e,t,n){"use strict";var i="core_deviceDetailIdentity/views/",a="/device/:deviceId";e.when(a,{templateUrl:i+"identity.html",priority:-1e3,name:n("Identity"),icon:"barcode",showIfPermissions:{anyRole:["ROLE_IDENTITY_READ","ROLE_IDENTITY_ADMIN"]}}),e.when("/identity",{template:"<div></div>",priority:1e4,controller:["$routeParams","$window","$location","c8yIdentity","c8yAlert","gettextCatalog",function(e,t,n,i,a,l){function r(){n.url("/device?text="+e.type+" "+e.externalId)}function d(t){var i=t.data,d=i.managedObject,o=d.id;o?(a.success(l.getString("Device found for identity {{type}}: {{externalId}}",e)),n.url("/device/"+o)):(a.danger(l.getString("Can't find managed for identity {{type}}: {{externalId}}!",e)),r())}e.type&&e.externalId?i.getExternalId(e).then(d,r):r()}]})}]),angular.module("c8y.deviceDetailIdentity").controller("deviceDetailIdentityCtrl",["$scope","$routeParams","c8yIdentity","c8yModal","c8yAlert","gettext","gettextCatalog",function(e,t,n,i,a,l,r){"use strict";function d(t){e.ids=t}function o(){c(),delete e.newId}function c(){return n.listExternalIds(g).then(d)}function s(e){i({title:l("Confirm delete?"),body:r.getString('Do you really want to remove the external identity "{{externalId}}" of the type {{idType}} ?',{externalId:e.externalId,idType:e.type}),status:"danger"}).then(_.partial(n.deleteIdentity,e)).then(c).then(_.partial(a.success,l("External ID deleted")))}function y(e){n.createIdentity(g,e).then(o).then(_.partial(a.success,l("External ID created")))}function u(){e.refreshLoading=!0,c().finally(function(){e.refreshLoading=!1})}function h(){e.newId={}}function p(){delete e.newId}var g=t.deviceId,I=l("The external Id is something that links the device information and the physical world (ex.: Serial Number, Imei). If for some reason the hardware needs to be replaced, so must the external id be replaced with the appropriate information. With this procedure the new hardware can continue linked to the information that was created by its predecessor");e.onClickDelete=s,e.create=y,e.paging={refresh:!0},e.refresh=u,e.add=h,e.cancel=p,e.helpText=I,c()}]),function(){"use strict";function e(e){var t;t='<div data-ng-controller="deviceDetailIdentityCtrl">\n  <div class="clearfix">\n    <c8y-refresh-btn class="pull-right" style="margin-bottom:20px"></c8y-refresh-btn>\n    <c8y-if-allowed any-role="[\'ROLE_IDENTITY_ADMIN\']">\n      <button class="btn btn-link pull-right" data-ng-click="add()">\n        <i c8y-icon="plus"></i> <translate>Add identity</translate>\n      </button>\n    </c8y-if-allowed>\n\n    <button class="btn btn-link pull-right" uib-popover="{{helpText | translate}}" popover-placement="bottom" popover-trigger="mouseenter">\n      <i c8y-icon="question-circle-o"></i>\n    </button>\n  </div>\n\n  <form role="form" name="newIdForm" class="panel-body" novalidate ng-show="newId">\n    <div class="row">\n      <div class="form-group col-lg-5">\n        <label translate>Type</label>\n        <input type="text" class="form-control" ng-model="newId.type" required>\n      </div>\n      <div class="form-group col-lg-7">\n        <label translate>Id</label>\n        <input type="text" class="form-control" ng-model="newId.externalId" ng-maxlength="680" required>\n      </div>\n    </div>\n    <div class="pull-right">\n      <button class="btn btn-primary" ng-click="create(newId)" ng-disabled="newIdForm.$invalid" translate>Save</button>\n      <button class="btn btn-default" ng-click="cancel()" translate>Cancel</button>\n    </div>\n  </form>\n\n  <div class="alert alert-warning" data-ng-show="ids.length === 0" translate>No external ids found!</div>\n\n  <table class="table" data-ng-show="ids && ids.length">\n    <thead>\n      <th translate>Type</th>\n      <th translate>Id</th>\n      <th></th>\n    </thead>\n    <tbody>\n      <tr data-ng-repeat="id in ids">\n        <td>{{id.type}}</td>\n        <td>{{id.externalId}}</td>\n        <td class="text-right">\n          <c8y-if-allowed any-role="[\'ROLE_IDENTITY_ADMIN\']">\n            <button class="btn btn-danger btn-xs showOnHover" title="{{\'Delete identity\' | translate}}" data-ng-click="onClickDelete(id)">\n              <i c8y-icon="times"></i>\n            </button>\n          </c8y-if-allowed>\n      </td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n',e.put("core_deviceDetailIdentity/views/identity.html",t),e.put("/apps/core/deviceDetailIdentity/views/identity.html",t)}angular.module("c8y.deviceDetailIdentity").run(["$templateCache",e])}();