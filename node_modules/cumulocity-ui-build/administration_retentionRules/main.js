/* administration_retentionRules 8.7.2 2017-08-02T09:53:15+00:00 79d3e7d78638 (hotfix/8.7.2) tip */
!function(){"use strict";function t(t,e,n){t.addNavigation({parent:n("Management"),name:n("Retention rules"),priority:2e3,path:"retentions",icon:"hdd-o"}),e.when("/retentions",{templateUrl:"administration_retentionRules/views/list.html"})}angular.module("c8y.parts.retentionRules",[]).config(["c8yNavigatorProvider","c8yViewsProvider","gettext",t])}(),function(){"use strict";function t(t,e,n,a,i,r,s,l){function o(){a.list({pageSize:1e3}).then(function(e){t.retentions=e,t.paging=e.paging},c)}function c(t){403===t.status?e.info(l("You need these roles to access retention rules: Retention Rule Read / Admin")):e.danger(s.getTranslatedServerMessage(t.data.message),t.data)}function u(t){return n({title:l("Are you sure?"),body:l("Do you want to remove this rule?"),status:"danger"}).then(_.partial(d,t))}function d(t){var n=_.partial(e.success,l("Rule is removed successfully."));return a.remove(t).then(_.partial(g,t)).then(n)}function g(e){_.remove(t.retentions,e)}function h(e){t.retentions.push(e)}function p(e){var n=_.find(t.retentions,{id:e.id});_.merge(n,e)}function f(){return i.editRetentionRule().then(h)}function m(t){if(b(t))return i.editRetentionRule(t).then(p)}function y(){r.changeTitle({title:l("Retention rules")}),o()}function b(t){return t.editable!==!1}y(),t.list=o,t.createModal=f,t.updateModal=m,t.removeWithConfirmation=u,t.isEditable=b}t.$inject=["$scope","c8yAlert","c8yModal","c8yRetentions","c8yUiUtil","c8yTitle","c8yLocales","gettext"],angular.module("c8y.parts.retentionRules").controller("c8yRetentionRulesListCtrl",t)}(),function(){"use strict";function t(t){var e;e='<div ng-controller="c8yRetentionRulesListCtrl">\n  <div class="clearfix">\n    <button type="button" class="pull-right btn btn-link" data-ng-disabled="!paging.refresh" data-ng-click="list()" style="margin-bottom:20px">\n        <i c8y-icon="refresh" data-ng-class="{\'fa-spin\': refreshLoading}"></i> <translate>Reload</translate>\n    </button>\n    <c8y-if-allowed any-role="[\'ROLE_RETENTION_RULE_ADMIN\']">\n      <a ng-click="createModal()" class="btn btn-link pull-right">\n          <i c8y-icon="plus"></i> <translate>Add rule</translate>\n      </a>\n    </c8y-if-allowed>\n  </div>\n\n  <table class="table table-striped">\n    <thead>\n      <tr>\n        <th class="text-center" translate>Data type</th>\n        <th class="text-center" translate>Fragment</th>\n        <th class="text-center" translate>Type </th>\n        <th class="text-center" translate>Source </th>\n        <th class="text-center" translate>Maximum age</th>\n        <th></th>\n      </tr>\n    </thead>\n\n    <tbody>\n      <tr ng-class="{interact: isEditable(rule)}" ng-repeat="rule in retentions" ng-click="updateModal(rule)">\n        <td class="text-center">\n          {{rule.dataType | translate}}\n        </td>\n\n        <td class="text-center">\n          {{rule.fragmentType}}\n        </td>\n\n        <td class="text-center">\n          {{rule.type}}\n        </td>\n\n        <td class="text-center">\n          {{rule.source}}\n        </td>\n\n        <td class="text-center">\n          {{rule.maximumAge}}\n        </td>\n\n        <td class="text-right" ng-hide="isEditable(rule)">\n          <span class="label label-info" translate>Not editable</span>\n        </td>\n\n        <td class="text-right" ng-show="isEditable(rule)">\n          <button class="btn btn-danger btn-xs showOnHover" title="{{\'Delete\' | translate}}" data-ng-click="removeWithConfirmation(rule);$event.stopPropagation()">\n            <i c8y-icon="times"></i>\n          </button>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n</div>\n',t.put("administration_retentionRules/views/list.html",e),t.put("/apps/administration/retentionRules/views/list.html",e)}angular.module("c8y.parts.retentionRules").run(["$templateCache",t])}();