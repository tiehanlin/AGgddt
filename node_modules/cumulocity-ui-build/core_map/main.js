/* core_map 8.7.2 2017-08-02T09:54:37+00:00 e22b35b1d531 (hotfix/8.7.2) tip */
!function(){"use strict";function e(e,t){e.add({name:"Map",nameDisplay:t("Map"),description:t("Displays a map with position markers for selected devices."),templateUrl:"core_map/views/component.html",options:{groupsSelectable:!0,deviceTargetNotRequired:!0}})}angular.module("c8y.cockpit.map",[]).config(["c8yComponentsProvider","gettext",e])}(),function(){"use strict";function e(e,t){e.cssClass="widget-map",e.mapConfig={centerPoint:{lat:51.235267210116255,lng:6.7144811153411865,zoom:11}},e.markerTemplate=function(){return"<div ng-include=\"'"+_.get(e,"child.config.markerTemplate",t)+"'\"></div>"}}angular.module("c8y.cockpit.map").controller("MapComponentCtrl",["$scope","MARKER_TEMPLATE",e])}(),function(){"use strict";function e(e,t,n,a,l){function r(){o(l)}function o(e){p(),_.forEach(e,function(e){e.draggable=!0,b.push(e),v.latlngs.push(e)}),n(s,0)}function c(e){a.geoCode(e).then(function(e){return e.data[0]||null}).then(i)}function i(e){e&&(k.center=_.assign(k.center,{lat:Number(e.lat),lng:Number(e.lon),zoom:17}))}function s(){v.latlngs.length>0&&(h.reset(),_.forEach(v.latlngs,function(e){h.add(e)}),k.bounds=h.get())}function p(){v.latlngs.length=0,b.length=0}function d(){t.close(g(v.latlngs))}function g(e){return _.map(e,function(e){return{lat:e.lat,lng:e.lng}})}function u(e,t){var n={lat:t.leafletEvent.latlng.lat,lng:t.leafletEvent.latlng.lng,draggable:!0};k.markers.push(n),v.latlngs.push(n)}function m(e,t){switch(e.name){case"leafletDirectiveMarker.dragstart":f={lat:t.model.lat,lng:t.model.lng,draggable:!0};break;case"leafletDirectiveMarker.dragend":var n={lat:t.model.lat,lng:t.model.lng,draggable:!0};v.latlngs[_.findIndex(v.latlngs,f)]=n}}var f,h=new a.Bounds,b=[],v={type:"polygon",stroke:!0,weight:1,color:"#2e3974",fillColor:"#2e3974",latlngs:[]},k={center:{},events:{},bounds:h.get(),markers:b,paths:{geofencePath:v}};e.gotoAddress=c,e.centerMap=s,e.clearGeofence=p,e.chooseGeofence=d,e.cancel=t.dismiss,e.map=k,e.$on("leafletDirectiveMap.click",u),e.$on("leafletDirectiveMarker.dragend",m),e.$on("leafletDirectiveMarker.dragstart",m),r()}e.$inject=["$scope","$uibModalInstance","$timeout","c8yGeo","geofenceLatLngs"],angular.module("c8y.cockpit.map").controller("GeofenceEditCtrl",e)}(),function(){"use strict";function e(e,t){function n(n){return e({title:t.getString("Edit geofence"),templateUrl:"core_map/views/geofenceEdit.html",controller:"GeofenceEditCtrl",size:"lg",resolve:{geofenceLatLngs:function(){return _.cloneDeep(n)}}})}return{showEditUI:n}}angular.module("c8y.cockpit.map").factory("geofenceSvc",["c8yModal","gettextCatalog",e])}(),function(){"use strict";function e(e){var t;t='<div class="component-map" ng-controller="MapComponentCtrl">\n  <div c8y-map-internal device-id="child.config.device.id" marker-template="markerTemplate" multiple-devices="true" config="mapConfig" realtime="true"></div>\n</div>\n',e.put("core_map/views/component.html",t),e.put("/apps/core/map/views/component.html",t),t='<!-- <div class="modal-header text-center">\r\n  <h3>{{title}}</h3>\r\n</div> -->\r\n\r\n\r\n<div class="modal-map">\r\n  <leaflet width="100%" height="600" bounds="map.bounds" center="map.center" markers="map.markers" paths="map.paths" event-broadcast="map.events"></leaflet>\r\n\r\n  <div class="panel-map">\r\n    <h3 style="margin-bottom: 10px">{{title}}</h3>\r\n    <p><i c8y-icon="info-circle text-primary"></i> <translate>Double click to add points and set the area. Click and drag the points to adjust.</translate></p>\r\n    <hr>\r\n    <div class="form-group">\r\n      <form name="searchAddressForm" novalidate ng-submit="gotoAddress(searchAddress)">\r\n        <div class="input-group input-group-search">\r\n          <input type="text" ng-model="searchAddress" placeholder="Enter address" class="form-control">\r\n          <span class="input-group-btn">\r\n            <button class="btn btn-link" type="submit">\r\n              <i c8y-icon="search"></i>\r\n            </button>\r\n          </span>\r\n        </div>\r\n      </form>\r\n    </div>\r\n    <button class="btn btn-default btn-block" ng-click="centerMap()" ng-show="map.paths.geofencePath.latlngs.length > 0"><i c8y-icon="dot-circle-o"></i> <translate>Center map</translate></button>\r\n    <button class="btn btn-danger btn-block" ng-click="clearGeofence()" ng-show="map.paths.geofencePath.latlngs.length > 0"><i c8y-icon="trash"></i> <translate>Clear geofence</translate></button>\r\n    <hr>\r\n    <button class="btn btn-default btn-block" ng-click="cancel()" translate>Cancel</button>\r\n    <button class="btn btn-primary btn-block" ng-click="chooseGeofence()" ng-disabled="map.paths.geofencePath.latlngs.length < 3" translate>Save</button>\r\n  </div>\r\n</div>\r\n',e.put("core_map/views/geofenceEdit.html",t),e.put("/apps/core/map/views/geofenceEdit.html",t)}angular.module("c8y.cockpit.map").run(["$templateCache",e])}();