/* core_configurationRepository 8.7.2 2017-08-02T09:54:04+00:00 e22b35b1d531 (hotfix/8.7.2) tip */
!function(){"use strict";function n(n,e,t){n.addNavigation({parent:t("Management"),name:t("Configuration repository"),priority:1e3,path:"configuration",icon:"gears"}),e.when("/configuration",{templateUrl:"core_configurationRepository/views/list.html"})}angular.module("c8y.configurationRepository",[]).config(["c8yNavigatorProvider","c8yViewsProvider","gettext",n])}(),function(){"use strict";function n(n,e,t,i,o,r,a,l,c){function s(){u(),d(),g()}function g(){e.add&&(C(),n.newCfg.deviceType=e.type)}function u(){o.changeTitle({title:l("Configuration snapshots repository")})}function d(n){return a.list(n).then(f)}function f(t){n.configurations&&!n.refreshLoading||(n.configurations=[]),n.paging=t.paging,t.forEach(function(t){n.configurations.push(t),t.id===e.id&&F.push(t)})}function p(){n.paging.loading=!0,n.paging.next().then(f).finally(function(){n.paging.loading=!1})}function m(){n.refreshLoading=!0,n.paging.refresh().then(f).finally(function(){n.refreshLoading=!1})}function y(n){return F.indexOf(n)}function v(n){return y(n)>-1}function b(n){v(n)?F.splice(y(n),1):F.push(n)}function h(e){r({title:l("Confirm delete?"),body:c.getString('Do you really want to remove "{{name}}" configuration?',e),status:"danger"}).then(angular.bind(a,a.remove,e)).then(angular.bind(i,i.removeFromList,n.configurations,e)).then(function(){t.success(l("Configuration successfully removed."))})}function w(n){a.save(n).then(angular.bind({},m)).finally(x)}function C(){n.newCfg=a.getEmpty()}function x(){n.newCfg=null}var F=[];n.loadNext=p,n.refresh=m,n.toggle=b,n.isOpen=v,n.onClickDelete=h,n.save=w,n.add=C,n.cancelAdd=x,n.invalid=angular.bind(i,i.invalid,n),s()}angular.module("c8y.configurationRepository").controller("configurationRepositoryListCtrl",["$scope","$routeParams","c8yAlert","c8yBase","c8yTitle","c8yModal","configurationRepositorySvc","gettext","gettextCatalog",n])}(),function(){"use strict";function n(n,e,t,i){function o(){var n={name:"",description:"",url:"",type:g};return n}function r(n){var t=a(n);return e.list(t)}function a(n){return _.assign({type:g},n||{})}function l(n){return c(n).then(e.save).then(function(){t.success(i("Configuration snapshot is successfully added."))})}function c(e){return e.selectedFile.url&&(e.url=e.selectedFile.url,delete e.selectedFile),n.when(e)}function s(n){return e.remove(n)}var g="c8y_ConfigurationDump";return{getEmpty:o,list:r,save:l,remove:s}}angular.module("c8y.configurationRepository").factory("configurationRepositorySvc",["$q","c8yInventory","c8yAlert","gettext",n])}(),function(){"use strict";function n(n){var e;e='<div ng-controller="configurationRepositoryListCtrl">\n  <div class="clearfix">\n    <c8y-refresh-btn class="pull-right" style="margin-bottom: 20px"></c8y-refresh-btn>\n    <button class="btn btn-link pull-right" ng-click="add()">\n      <i c8y-icon="plus"></i> {{\'Add configuration snapshot\' | translate}}\n    </button>\n  </div>\n\n  <form role="form" name="newCfgForm" class="panel-body" novalidate ng-show="!!newCfg.type">\n    <div class="row">\n      <div class="form-group col-lg-3" ng-class="{\'has-error\': invalid(\'newCfgForm\', \'name\')}">\n        <label for="name">{{\'Name\' | translate}}</label>\n        <input id="name" name="name" type="text" class="form-control" ng-model="newCfg.name" ng-maxlength="60" required>\n      </div>\n      <div class="form-group col-lg-3" ng-class="{\'has-error\': invalid(\'newCfgForm\', \'description\')}">\n        <label for="description">{{\'Description\' | translate}}</label>\n        <input id="description" name="description" type="text" class="form-control" ng-model="newCfg.description" ng-maxlength="200">\n      </div>\n      <div class="form-group col-lg-3" ng-class="{\'has-error\': invalid(\'newCfgForm\', \'deviceType\')}">\n        <label for="deviceType">{{\'Device type\' | translate}}</label>\n        <i c8y-icon="question-circle-o" uib-tooltip="{{\'The device type can be found in the device information tab of the target device.\' | translate}}"></i>\n        <input id="deviceType" name="deviceType" ng-model="newCfg.deviceType" type="text" class="form-control" placeholder="e.g.: c8y_OBU-GT">\n      </div>\n      <div class="form-group col-lg-3">\n        <label>{{\'Configuration snapshot file\' | translate}}</label>\n        <c8y-binary-input initial-url="newCfg.url" output-file="newCfg.selectedFile" allow-free-url-input="true" file-required="true"></c8y-binary-input>\n      </div>\n    </div>\n    <button class="btn btn-primary" ng-click="save(newCfg)" ng-disabled="newCfgForm.$invalid">{{\'Save\' | translate}}</button>\n    <button class="btn btn-default" ng-click="cancelAdd()">{{\'Cancel\' | translate}}</button>\n  </form>\n\n  <table class="table">\n    <thead>\n      <tr>\n        <th>{{\'Name\' | translate}}</th>\n        <th>{{\'Description\' | translate}}</th>\n        <th>{{\'Device type\' | translate}}</th>\n        <th></th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr ng-repeat-start="cfg in configurations" class="interact" ng-class="{active: isOpen(cfg)}">\n        <td ng-click="toggle(cfg)" class="word-break">{{cfg.name}}</td>\n        <td ng-click="toggle(cfg)" class="word-break">{{cfg.description}}</td>\n        <td ng-click="toggle(cfg)" class="word-break">{{cfg.deviceType}}</td>\n        <td class="text-right">\n          <button class="btn btn-danger btn-xs showOnHover" title="{{\'Remove configuration snapshot\' | translate}}" ng-click="onClickDelete(cfg)">\n            <i c8y-icon="times"></i>\n          </button>\n        </td>\n      </tr>\n      <tr ng-repeat-end ng-if="isOpen(cfg)">\n        <td colspan="3">\n          <form name="cfgForm" role="form" class="panel-body">\n            <div class="row">\n              <div class="form-group col-lg-3" ng-class="{\'has-error\': cfgForm.name.$dirty && cfgForm.name.$invalid}">\n                <label>{{\'Name\' | translate}}</label>\n                <input type="text" class="form-control" name="name" ng-model="cfg.name" required ng-maxlength="60">\n              </div>\n              <div class="form-group col-lg-3" ng-class="{\'has-error\': cfgForm.description.$dirty && cfgForm.description.$invalid}">\n                <label>{{\'Description\' | translate}}</label>\n                <input type="text" class="form-control" name="description" ng-model="cfg.description" ng-maxlength="200">\n              </div>\n              <div class="form-group col-lg-3" ng-class="{\'has-error\': invalid(\'newCfgForm\', \'deviceType\')}">\n                <label for="deviceType">{{\'Device type\' | translate}}</label>\n                <i c8y-icon="question-circle-o" uib-tooltip="{{\'The device type can be found in the device information tab of the target device.\' | translate}}"></i>\n                <input id="deviceType" name="deviceType" ng-model="cfg.deviceType" type="text" class="form-control" placeholder="e.g.: c8y_OBU-GT">\n              </div>\n              <div class="form-group col-lg-3">\n                <label>{{\'Configuration snapshot file\' | translate}}</label>\n                <c8y-binary-input initial-url="cfg.url" output-file="cfg.selectedFile" allow-free-url-input="true" file-required="true"></c8y-binary-input>\n              </div>\n            </div>\n            <button class="btn btn-primary" ng-click="save(cfg)" ng-disabled="cfgForm.$invalid">{{\'Save\' | translate}}</button>\n            <button class="btn btn-default" ng-click="toggle(cfg)">{{\'Close\' | translate}}</button>\n          </form>\n        </td>\n      </tr>\n    <tbody>\n  </tbody></tbody></table>\n  <c8y-load-more></c8y-load-more>\n</div>\n',n.put("core_configurationRepository/views/list.html",e),n.put("/apps/core/configurationRepository/views/list.html",e)}angular.module("c8y.configurationRepository").run(["$templateCache",n])}();