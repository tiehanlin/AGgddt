/* demoboard_windmillTixiDemo 8.7.2 2017-08-02T09:53:13+00:00 c1f802513a81 (hotfix/8.7.2) tip */
!function(){"use strict";function n(n){n.add({name:"Windmill Tixi Demo",description:"Allows for controlling a windmill with Tixi commands",templateUrl:"demoboard_windmillTixiDemo/views/windmill.html",configTemplateUrl:"demoboard_windmillTixiDemo/views/config.html"})}angular.module("c8y.demoboard.windmillTixi",[]).config(["c8yComponentsProvider",n])}(),function(){"use strict";function n(n,e,i,o,t){function l(){var i=e.deviceId;return n.child.config&&n.child.config.device&&n.child.config.device.id&&(i=n.child.config.device.id),i}function d(){return{name:n.child.config&&n.child.config.windmill&&n.child.config.windmill.name,number:n.child.config&&n.child.config.windmill&&n.child.config.windmill.number,mode:null,speed:null}}function r(){}function m(){}function c(n){return n===f.mode}function a(n){return t.setMode(v,f,n).then(function(){f.mode=n})}function s(n){return t.setSpeed(v,f,n).then(function(){f.speed=n})}function u(n){return n.charAt(0).toUpperCase()+n.slice(1).toLowerCase()}var v=l(),f=d();n.deviceId=v,n.windmill=f,n.Modes=t.Modes,n.isModeSet=c,n.setMode=a,n.setSpeed=s,n.humanize=u,n.invalid=angular.bind(i,i.invalid,n,"windmillForm"),n.$on("$destroy",m),r()}angular.module("c8y.demoboard.windmillTixi").controller("windmillTixiCtrl",["$scope","$routeParams","c8yBase","c8yAlert","windmillSvc",n])}(),function(){"use strict";function n(n,e,i,o){function t(n,e,i){var o={deviceId:n.id||n,description:"Setting mode "+i.name+" for Windmill "+e.name,c8y_Command:{text:'[<Set _="/Process/PV/Windmill'+e.number+'Mode" value="'+i.value+'" ver="v"/>]'}};return v(o)}function l(n,e,i){var o={deviceId:n.id||n,description:"Setting speed "+i+" for Windmill "+e.name,c8y_Command:{text:'[<Set _="/Process/PV/WindMill'+e.number+'_Setpoint" value="'+i+'" ver="v"/>]'}};return v(o)}function d(n){var i=n.deviceId;p[i]?p[i].count++:p[i]={promise:e(_.partial(m,i),g),count:1}}function r(n){var i=n.deviceId;p[i]&&(p[i].count--,p[i].count<1&&(e.cancel(p[i].promise),delete p[i]))}function m(n){c(n).then(function(e){if(s(e))return u(n)})}function c(e){var i=10,o=[];return a(e,i,1,!0).then(function(t){var l=t.statistics.totalPages;return o.push(a(e,i,l)),l>1&&o.push(a(e,i,l-1)),n.all(o)})}function a(n,e,i,t){return o.list({deviceId:n,pageSize:e,currentPage:i,withTotalPages:t})}function s(n){return 0===_(_.flattenDeep(n)).filter(function(n){return!_.isUndefined(n[w])&&moment().subtract(b.value,b.units).isBefore(n.creationTime)}).value().length}function u(n){var e={deviceId:n,description:"Get measurements",c8y_MeasurementRequestOperation:{requestName:"LOG"}};return v(e)}function v(n){return o.create(n)}var f=i.createEnum([{name:"OFF",value:"0"},{name:"MANUAL",value:"1"},{name:"AUTO",value:"2"}]),p={},g=11e3,w="c8y_MeasurementRequestOperation",b={value:10,units:"seconds"};return{Modes:f,setMode:t,setSpeed:l,initComponent:d,destroyComponent:r}}angular.module("c8y.demoboard.windmillTixi").factory("windmillSvc",["$q","$interval","c8yBase","c8yDeviceControl",n])}(),function(){"use strict";function n(n){var e;e='<div>\r\n  <div class="form-group">\r\n    <label>Windmill\'s name</label>\r\n    <input class="form-control" type="text" ng-model="config.windmill.name" required/>\r\n  </div>\r\n  <div class="form-group">\r\n    <label>Windmill\'s number</label>\r\n    <input class="form-control" type="number" ng-model="config.windmill.number" required/>\r\n  </div>\r\n</div>\r\n',n.put("demoboard_windmillTixiDemo/views/config.html",e),n.put("/apps/demoboard/windmillTixiDemo/views/config.html",e),e='<div ng-controller="windmillTixiCtrl" class="windmill">\n  <form name="windmillForm" role="form" novalidate>\n    <div class="row">\n      <div class="col-lg-12">\n        <span class="windmill-name">\n          {{windmill.name}}\n        </span>\n        <p class="windmill-icon">\n          <img src="demoboard_windmillTixiDemo/images/windmill.png"/>\n        </p>\n        <div class="form-group">\n          <div class="btn-group">\n            <button type="button" class="btn btn-default" ng-repeat="mode in Modes" ng-if="mode.name" ng-click="setMode(mode)" ng-class="{active: isModeSet(mode)}">\n              {{humanize(mode.name)}}\n            </button>\n          </div>\n        </div>\n        <div class="form-group" ng-show="isModeSet(Modes.MANUAL)" ng-class="{\'has-error\': invalid(\'speedSetpoint\')}">\n          <input type="number" class="form-control" id="speedSetpoint" name="speedSetpoint" ng-model="windmill.speed" min="0" max="100" ng-required="isModeSet(Modes.MANUAL)">\n          <button class="btn btn-primary" type="button" ng-click="setSpeed(windmill.speed)" ng-disabled="!isModeSet(Modes.MANUAL) || windmillForm.$invalid">Set speed</button>\n        </div>\n      </div>\n    </div>\n  </form>\n</div>\n',n.put("demoboard_windmillTixiDemo/views/windmill.html",e),n.put("/apps/demoboard/windmillTixiDemo/views/windmill.html",e)}angular.module("c8y.demoboard.windmillTixi").run(["$templateCache",n])}();