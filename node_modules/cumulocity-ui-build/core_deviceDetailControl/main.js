/* core_deviceDetailControl 8.7.2 2017-08-02T09:54:12+00:00 e22b35b1d531 (hotfix/8.7.2) tip */
angular.module("c8y.deviceDetailControl",[]).config(["c8yViewsProvider","gettext",function(e,n){"use strict";var t="core_deviceDetailControl/views/",a="/device/:deviceId";e.when(a,{templateUrl:t+"control.html",priority:600,name:n("Control"),icon:"c8y-device-control",controller:["$scope","$routeParams","c8yDevices",function(e,n,t){e.device={},t.detail(n.deviceId).then(function(n){e.device=n.data})}]})}]),angular.module("c8y.deviceDetailControl").controller("deviceDetailControlCtrl",["$scope","c8yBase","c8yDevices","c8yDeviceControl","c8yAlert","c8yConfig","gettext","gettextCatalog",function(e,n,t,a,i,r,l,s){"use strict";function c(n){if(!e.showControls)return!1;var t=!1;if(e.device){var a=o("c8y_TraceStatus"),i=o("c8y_Restart"),r=o("c8y_Relay"),l=o("c8y_Message"),s=o("c8y_RelayArray");t="trace"===n?a:"restart"===n?i:"relay"===n?r:"message"===n?l:"relayarray"===n?s:a||i||r||l||s}return t}function o(n){return t.supportsOperation(e.device,n)}function d(){y("ON")}function v(){y("OFF")}function y(e){b({description:s.getString("Trace status to {{traceState}}",{traceState:e}),c8y_TraceStatus:{state:e}})}function p(){b({description:l("Restart device"),c8y_Restart:{}})}function u(n){e.device.c8y_Relay&&e.device.c8y_Relay.relayState&&(e.device.c8y_Relay.relayState=n),b({description:s.getString("Update relay status to {{relayStatus}}",{relayStatus:n}),c8y_Relay:{relayState:n}})}function g(n,t){var a={};a.description=("CLOSED"===n?"Closing":"Opening")+" relay "+(t+1)+".",a.c8y_RelayArray=e.device.c8y_RelayArray,a.c8y_RelayArray[t]=n,b(a)}function f(e){b({description:s.getString('Send message "{{msg}}"',{msg:e}),c8y_Message:{text:e}})}function b(n,t){return n.deviceId=e.device.id,a.create(n).then(function(){h(n,t)})}function h(n,t){i.success(s.getString('Created operation: "{{opDescription}}"!',{opDescription:n.description})),t&&e.$emit("update","devicecontrol")}e.showControls=r.deviceDetailControl.showControls,e.visible=c,e.supportsOperation=o,e.traceStatusOn=d,e.traceStatusOff=v,e.restart=p,e.relay=u,e.relayarray=g,e.message=f}]),function(){"use strict";function e(e){var n;n='<div class="row" ng-controller="deviceDetailControlCtrl">\n  <div class="col-lg-4" ng-show="visible()">\n    <div ng-show="visible(\'trace\')">\n      <div class="panel panel-default">\n        <div class="panel-heading">\n          <i c8y-icon="bug"></i>\n          <translate>Trace status</translate>\n        </div>\n        <div class="panel-body">\n          <p translate>Send an operation to start or stop device internal tracing. Result of tracing is device dependent, it can generate more events or generate a file inside the device.</p>\n        </div>\n        <div class="panel-footer">\n          <div class="btn-group">\n            <a class="btn btn-primary" href="" ng-click="traceStatusOn(deviceDetail)" translate>On</a>\n            <a class="btn btn-default" href="" ng-click="traceStatusOff(deviceDetail)" translate>Off</a>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="visible(\'restart\')">\n      <div class="panel panel-default">\n        <div class="panel-heading">\n          <i c8y-icon="refresh"></i>\n          <translate>Restart device</translate>\n        </div>\n        <div class="panel-body">\n          <p translate>Send an operation to restart the device. The process of restart can be monitored under the operations of the device.</p>\n        </div>\n        <div class="panel-footer">\n          <div class="controls">\n            <button class="btn btn-primary" ng-click="restart(deviceDetail)" translate>Restart</button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="visible(\'relay\')">\n      <div class="panel panel-default">\n        <div class="panel-heading">\n          <i c8y-icon="lightbulb-o"></i>\n          <translate>Relay</translate>\n        </div>\n        <div class="panel-body">\n          <p translate>Send an operation to switch a relay on or off.</p>\n        </div>\n        <div class="panel-footer">\n          <div class="btn-group">\n            <a class="btn btn-{{device.c8y_Relay.relayState===\'CLOSED\'?\'primary\':\'default\'}}" href="" ng-click="relay(\'CLOSED\')" translate>On</a>\n            <a class="btn btn-{{device.c8y_Relay.relayState===\'OPEN\'?\'primary\':\'default\'}}" href="" ng-click="relay(\'OPEN\')" translate>Off</a>\n          </div>\n        </div>\n      </div>\n    </div>\n\n\t<div ng-show="visible(\'relayarray\')">\n      <div class="panel panel-default">\n        <div class="panel-heading">\n          <i c8y-icon="lightbulb-o"></i>\n          <translate>Array of Relays</translate>\n        </div>\n        <div class="panel-body">\n          <p translate>Send an operation to switch an array of relays on or off.</p>\n        </div>\n        <div class="panel-footer">\n          <div class="btn-group">\n            <a ng-repeat="rl in device.c8y_RelayArray track by $index" class="btn btn-{{rl===\'CLOSED\'?\'primary\':\'default\'}}" ng-click="relayarray(rl===\'CLOSED\'?\'OPEN\':\'CLOSED\', $index)">{{$index + 1}}</a>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div ng-show="visible(\'message\')">\n      <div class="panel panel-default">\n        <div class="panel-heading">\n          <i c8y-icon="comment"></i>\n          <translate>Send message</translate>\n        </div>\n        <div class="panel-body">\n          <p translate>Send an operation to show a particular message to the device. The device behavior is device dependent.</p>\n          <div class="form-group">\n            <input type="text" class="form-control" ng-model="str">\n          </div>\n        </div>\n        <div class="panel-footer">\n          <button class="btn btn-primary" ng-click="message(str)" ng-disabled="!str" translate>Send</button>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div ng-class="{\'col-lg-12\': !visible(), \'col-lg-8\': visible()}" ng-include="\'/apps/devicemanagement/deviceControlList/views/index.html\'"></div>\n</div>\n',e.put("core_deviceDetailControl/views/control.html",n),e.put("/apps/core/deviceDetailControl/views/control.html",n)}angular.module("c8y.deviceDetailControl").run(["$templateCache",e])}();