/* cockpit_reports 8.7.2 2017-08-02T09:53:16+00:00 820f9e1be195 (hotfix/8.7.2) tip */
!function(){"use strict";function e(e,t,n){var r={text:n("Create new report"),action:["c8yReports",function(e){return e.createUI().then(e.save)}],showIfPermissions:{anyRole:["ROLE_INVENTORY_ADMIN","ROLE_INVENTORY_CREATE"]}},o="/reports/:reportId",i={template:'<c8y-dashboard-gridstack name="{{dashboardName}}" default-children="children"></c8y-dashboard-gridstack>',controller:"ReportsCtrl"};e.addGlobalAction(r),t.when(o,i)}function t(e){e.initialize()}angular.module("c8y.cockpit.reports",[]).config(["c8yActionsProvider","c8yViewsProvider","gettext",e]).run(["c8yReports",t])}(),function(){"use strict";function e(e,o,i,a,c,s,l){function d(){return a.list(n)}function u(e){return e[t]||(e[t]={}),e}function p(e){u(e);var t=a[e.id?"save":"createConfirm"](e);return e.id?c.findNode(y(e)).update(e):t.then(i.getResData).then(function(e){c.addNavigation(g(e))}),t}function m(){return d().then(h).then(f)}function f(){var e=c.findNode(v);e&&e.update({sortAlphabetically:!0})}function v(e){return"Reports"===e.name}function h(e){c.addNavigation(_.map(e,g))}function g(e){return{report_id:e.id,path:r+e.id,name:e.name,icon:e.icon,parent:l("Reports")}}function y(e){return function(t){return t.report_id===e.id}}function b(e){s.named(I(e)).then(s.remove);var t=c.findNode(y(e));return c.removeNavigation(t),a.remove(e)}function R(e){var t={templateUrl:"cockpit_reports/views/edit.html",controller:"ReportDetailCtrl",resolve:{report:function(){return e?a.detail(e).then(i.getResData):{}}}};return o.open(t).result}function N(e){return!!e[t]}function I(e){if(!e)throw new Error("Must define a report");return"report_"+(e.id||e)}return{initialize:m,save:p,list:d,remove:b,detail:a.detail,createUI:R,editUI:R,isReport:N,dashboardName:I}}e.$inject=["$filter","$uibModal","c8yBase","c8yInventory","c8yNavigator","dashboardSvc","gettext"],angular.module("c8y.cockpit.reports").factory("c8yReports",e);var t="c8y_Report",n={fragmentType:t,pageSize:1e3},r="reports/"}(),function(){"use strict";function e(e,t,n,r,o,i,a,c,s){function l(){n.path("/")}function d(){r.detail(p).then(u)}function u(t){var n=t.data;r.isReport(n)&&(e.dashboardName=r.dashboardName(n),e.reportName=n.name)}var p=t.reportId,m={text:i("Remove report"),action:function(){a({title:i("Confirm delete?"),body:s.getString('Do you really want to remove report "{{name}}"?',{name:e.reportName}),status:"danger"}).then(angular.bind(r,r.remove,{id:p})).then(l).then(_.partial(c.success,i("Report successfully removed!")))}},f={text:i("Edit report"),action:function(){r.editUI(p).then(r.save)}};d(),o.addAction(m),o.addAction(f)}angular.module("c8y.cockpit.reports").controller("ReportsCtrl",["$scope","$routeParams","$location","c8yReports","c8yActions","gettext","c8yModal","c8yAlert","gettextCatalog",e])}(),function(){"use strict";function e(e,t,n,r,o){function i(){t.close(r)}e.title=o(r.id?"Edit report":"Create report"),e.report=r,e.cancel=t.dismiss,e.save=i,e.icons=n}angular.module("c8y.cockpit.reports").controller("ReportDetailCtrl",["$scope","$uibModalInstance","iconList","report","gettext",e])}(),function(){"use strict";function e(e){var t;t='<div class="modal-header">\n  <h3>{{title | translate}}</h3>\n</div>\n\n<div class="modal-body">\n  <form name="reportForm">\n\n    <div class="form-group">\n      <label translate>Name</label>\n      <input class="form-control" name="name" ng-model="report.name" required>\n    </div>\n\n    <div class="form-group">\n      <label translate>Icon</label>\n      <ui-select ng-model="report.icon">\n        <ui-select-match placeholder="{{\'Select or search icon\' | translate}}">\n          <i c8y-icon="{{$select.selected}}"></i>\n          {{$select.selected}}\n        </ui-select-match>\n        <ui-select-choices repeat="item in icons | filter: $select.search">\n          <div>\n            <i c8y-icon="{{item}}"></i> {{item}}\n          </div>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n  </form>\n\n</div>\n\n<div class="modal-footer">\n  <button class="btn btn-primary" ng-click="save()" ng-disabled="reportForm.$invalid" translate>Save</button>\n  <button class="btn btn-default" ng-click="cancel()" translate>Cancel</button>\n</div>\n',e.put("cockpit_reports/views/edit.html",t),e.put("/apps/cockpit/reports/views/edit.html",t)}angular.module("c8y.cockpit.reports").run(["$templateCache",e])}();