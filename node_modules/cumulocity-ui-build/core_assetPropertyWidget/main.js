/* core_assetPropertyWidget 8.7.2 2017-08-02T09:53:41+00:00 e22b35b1d531 (hotfix/8.7.2) tip */
!function(){"use strict";function e(e,t){e.add({name:"Asset Properties",nameDisplay:t("Asset properties"),description:t("Editable form for asset properties."),templateUrl:"core_assetPropertyWidget/views/main.html",configTemplateUrl:"core_assetPropertyWidget/views/config.html",options:{groupsSelectable:!0}})}angular.module("c8y.parts.assetPropertyWidget",[]).config(["c8yComponentsProvider","gettext",e])}(),function(){"use strict";function e(e,t,n,a,c,r,i){function o(){e.$emit("stopRealtime");var t=s();n.detailRealtime(e.child.config.device.id,e).then(function(n){return e.managedObject=n,c.attach(e.managedObject,t),a.getSchema(t)}).then(function(t){e.schema=t,l()})}function s(){var t=e.child.config.options||{},n=t.properties||[];return _.filter(n,"__active")}function l(){p(!0)}function d(){e.managedObject=_.cloneDeep(e.managedObject),c.attach(e.managedObject,s()),p(!1)}function p(t){var n={};t&&(n.readonly=t,n.feedback=!1,n.disableSuccessState=!0,n.disableErrorState=!0),a.getForm(s(),n).then(function(n){e.form=n,e.editable=!t})}function u(){d()}function m(){o()}function f(e){return g(e).then(n.save).then(function(){r.success(i("Changes saved!"))}).then(o)}function g(e){var n={id:e.id};return _.forEach(s(),function(t){return!!t.computed||void(n[t.keyPath[0]]=e[t.keyPath[0]])}),t.when(n)}e.startEdit=u,e.cancelEdit=m,e.save=f,e.$watch("child.config.options",function(){o()})}e.$inject=["$scope","$q","c8yInventory","c8yPropertiesLibrary","c8yComputedProperties","c8yAlert","gettext"],angular.module("c8y.parts.assetPropertyWidget").controller("assetPropertyWidgetCtrl",e)}(),function(){"use strict";function e(e){var t;t='<c8y-property-selector properties="config.options.properties" managed-object="config.device" hide-actions="true" hide-computed="true" show-render-type="false" include-tree-children="true" default-properties="[\'c8ySchema!!id\', \'c8ySchema!!name\', \'c8ySchema!!type\']" allow-duplicates="false" single-property-selection="false">\n</c8y-property-selector>\n',e.put("core_assetPropertyWidget/views/config.html",t),e.put("/apps/core/assetPropertyWidget/views/config.html",t),t='<div ng-controller="assetPropertyWidgetCtrl">\n  <div class="card-block">\n    <c8y-schema-form schema="schema" form="form" model="managedObject" ng-class="{\'form-read-only\': !editable}"></c8y-schema-form>\n    <c8y-if-allowed admin-mos="[managedObject]">\n      <button class="btn btn-default" ng-click="startEdit()" ng-show="!editable"><i c8y-icon="pencil"></i><translate>Edit</translate></button>\n      <button class="btn btn-default" ng-click="cancelEdit()" ng-show="editable" translate>Cancel</button>\n      <button class="btn btn-primary" ng-click="save(managedObject)" ng-show="editable" translate>Save</button>\n    </c8y-if-allowed>\n  </div>\n</div>\n',e.put("core_assetPropertyWidget/views/main.html",t),e.put("/apps/core/assetPropertyWidget/views/main.html",t)}angular.module("c8y.parts.assetPropertyWidget").run(["$templateCache",e])}();